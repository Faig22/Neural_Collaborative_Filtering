# Neural_Collaborative_Filtering
Тестовое задание (Стажировка VK)
## Создание рекомендательной системы на основе глубокого обучения
### Загрузка данных
Полный датасет был загружен с сайта https://grouplens.org/datasets/movielens/latest/ 
### Разведочный анализ данных
1. Отобразили график распределения оценок фильмов у всех пользователей
2. Построили гистограмму кол-ва жанров, представленных в датасете
### Разбиение данных на обучение и валидацию 
Т.к. в датасете **ratings** есть временная метка, когда была поставлена оценка фильму, было решено в валидационный датасет записать последнюю оценку каждого пользователя.

**train_ratings.shape** = *(27470216, 4)*

**test_ratings.shape** = *(283228, 4)*
### Создание датасета
Представили задачу в виде бинарной классификации. Если пользователь поставил оценку ниже 3, то метка равна нулю (label = 0), если выше, то метка равна единице (label = 1)
### Разработка архитектуры нейронной сети
Ниже представлена архитектура нейронной сети

![image](https://github.com/Faig22/Neural_Collaborative_Filtering/assets/95417164/ed067a1e-3dbe-4107-a951-7d6ee455885b)

Для обучения были использованы векторные представления пользователей и фильмов, далее объединили полученные эмбеддинги и пропустили через два линейных слоя нейронной сети 
### Обучение
Параметры обучения
1. **Batch_size** = *512*
2. **Num_epoch** = *5*
3. **Loss_function** = **nn.BCELoss()**
4. **Optimizer** = **torch.optim.Adam()**

**train_loss** = *0.347*, **val_loss** = *0.376*
### Метрика ранжирования
Использовали модифицированную **Hit Ratio @ k**

Для каждого пользователя были выбраны 99 случайных фильма, которые он не смотрел и один фильм, который он оценил последним (из валидационной выборки). Далее делается предсказание модели на этих 100 фильмах. Если фильм, который пользователь оценил последним понравился (оценка от *3* и выше) и попало в топ *k* по предсказаниям, значит рекомендация хорошая и метрика равна *1*. Если этот фильм получил низкую оценку (оценка ниже *3*) и не попал в топ *k* по предсказаниям, значит и здесь хорошая рекомендация и метрика тоже будет равна *1*. В остальных случаях метрика будет равна *0*.

**Hit Ratio @ 10** = *0.478*

